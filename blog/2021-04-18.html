<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>A RESTful service factory approach for NuxtJS | brandoverman</title>
    <meta name="description" content="A RESTful service factory approach for NuxtJS">
    <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="keywords" content="nuxt restful api services factory axios plugin reuse">
    <link rel="preload" href="/assets/css/0.styles.1be0746b.css" as="style"><link rel="preload" href="/assets/js/app.0017e748.js" as="script"><link rel="preload" href="/assets/js/2.e16f93d1.js" as="script"><link rel="preload" href="/assets/js/6.fbd6bd58.js" as="script"><link rel="prefetch" href="/assets/js/10.e77f6026.js"><link rel="prefetch" href="/assets/js/11.6cfc060e.js"><link rel="prefetch" href="/assets/js/12.313dfec9.js"><link rel="prefetch" href="/assets/js/3.3988afbb.js"><link rel="prefetch" href="/assets/js/4.5dfa825b.js"><link rel="prefetch" href="/assets/js/5.290100a7.js"><link rel="prefetch" href="/assets/js/7.1a0d9e9e.js"><link rel="prefetch" href="/assets/js/8.446675c1.js"><link rel="prefetch" href="/assets/js/9.0f488398.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1be0746b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">brandoverman</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/brandoverman" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/brandoverman" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="a-restful-service-factory-approach-for-nuxtjs"><a href="#a-restful-service-factory-approach-for-nuxtjs" aria-hidden="true" class="header-anchor">#</a> A RESTful service factory approach for NuxtJS</h1> <h2 id="nuxt-and-axios"><a href="#nuxt-and-axios" aria-hidden="true" class="header-anchor">#</a> Nuxt and Axios</h2> <p><a href="https://nuxtjs.org/" target="_blank" rel="noopener noreferrer">NuxtJS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> provides out-of-the-box support for the excellent http client, <a href="https://github.com/nuxt-community/axios-module/" target="_blank" rel="noopener noreferrer">Axios<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. The default implementation enables developers to access all the power of Axios through the $axios property. For simple applications, that's probably all you need but as the scope of your application increases, you're going to want to centralize your RESTful API code. The goal of this post is to describe an approach where the API logic is wrapped in a service factory, abstracting the specific Axios implementation. In fact, outside of the service factory, the application doesn't need to have any knowledge of Axios at all.</p> <p>This post will demostrate the concept by creating a simple application that displays jokes to the user by making an API call to <a href="https://jokeapi.dev/" target="_blank" rel="noopener noreferrer">JokeAPI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. The source code for the examples can be found <a href="https://github.com/brandoverman/nuxt-service-factory" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h2 id="nuxt-plugins"><a href="#nuxt-plugins" aria-hidden="true" class="header-anchor">#</a> Nuxt plugins</h2> <p>The magic of <a href="https://nuxtjs.org/docs/2.x/directory-structure/plugins" target="_blank" rel="noopener noreferrer">Nuxt plugins<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> makes creating a service factory relatively simple. In this case, it all starts by adding a folder, <code>services</code> to the default Nuxt folder structure. Within the <code>services</code> folder, we'll create the joke API module.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">// services/jokesService.ts</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> AxiosInstance <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;axios&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> JokesService <span class="token operator">=</span> ReturnType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> useJokesService<span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">useJokesService</span><span class="token punctuation">(</span><span class="token parameter">axios<span class="token punctuation">:</span> AxiosInstance</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getJoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>
      <span class="token string">&quot;https://v2.jokeapi.dev/joke/Any?type=single&amp;safe-mode&quot;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>joke <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    getJoke<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> useJokesService<span class="token punctuation">,</span> JokesService <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Next we'll create the service factory wrapper and the NuxtJS plugin.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">// services/serviceFactory.ts</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> NuxtAxiosInstance <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nuxtjs/axios&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useJokesService<span class="token punctuation">,</span> JokesService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./jokesService&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> jokesService<span class="token punctuation">:</span> JokesService <span class="token operator">|</span> undefined<span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> $axios <span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> $axios<span class="token punctuation">:</span> NuxtAxiosInstance <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// this is also where you would configure Axios.</span>
  jokesService <span class="token operator">=</span> <span class="token function">useJokesService</span><span class="token punctuation">(</span>$axios<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> serviceFactory <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">useJokesService</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> jokesService <span class="token keyword">as</span> JokesService<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> serviceFactory <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>The default export is the entry point of the NuxtJS plugin. When the plugin is invoked, the <code>jokesService</code> object is set and assigned as the output of the <code>useJokesServices</code> function. We're now all set to use <code>serviceFactory</code> in our code.</p> <h2 id="using-servicefactory"><a href="#using-servicefactory" aria-hidden="true" class="header-anchor">#</a> Using <code>serviceFactory</code></h2> <p>Making API calls is now as simple as importing <code>serviceFactory</code> and invoking the <code>useJokesService</code> method. For example <code>serviceFactory</code> can be used within a Vue component like this;</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> serviceFactory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;~/services/serviceFactory&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> jokeService<span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      joke<span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    jokeService <span class="token operator">=</span> serviceFactory<span class="token punctuation">.</span><span class="token function">useJokesService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">async</span> <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>joke <span class="token operator">=</span> <span class="token keyword">await</span> jokeService<span class="token punctuation">.</span><span class="token function">getJoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token keyword">async</span> <span class="token function">getAnotherJoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>joke <span class="token operator">=</span> <span class="token keyword">await</span> jokeService<span class="token punctuation">.</span><span class="token function">getJoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>As you can see there's no reference to Axios in the Vue component. This concept can be extended to include multiple services, all instantiated through <code>serviceFactory</code>.</p> <h2 id="other-benefits"><a href="#other-benefits" aria-hidden="true" class="header-anchor">#</a> Other benefits</h2> <p>Besides abstracting and centralizing the API logic, this approach can aid unit testing. With <a href="https://jestjs.io/" target="_blank" rel="noopener noreferrer">Jest<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, for example, modules can be mocked and as such mocking <code>serviceFactory</code> should be relatively straight forward. In addition, if you opt to use a different http client, you only need to modify the services, leaving the rest of the application in tact.</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.0017e748.js" defer></script><script src="/assets/js/2.e16f93d1.js" defer></script><script src="/assets/js/6.fbd6bd58.js" defer></script>
  </body>
</html>
